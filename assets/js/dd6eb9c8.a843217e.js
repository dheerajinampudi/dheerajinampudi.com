"use strict";(self.webpackChunkmy_portfolio=self.webpackChunkmy_portfolio||[]).push([[518],{9255:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"AI Space/Transformers/Transformer-Intro","title":"Understanding Attention and Transformer Architectures","description":"- RNNs (Storyteller): Reads a story word by word, remembering only what came before to predict what comes next.","source":"@site/docs/AI Space/01-Transformers/Transformer-Intro.md","sourceDirName":"AI Space/01-Transformers","slug":"/AI Space/Transformers/Transformer-Intro","permalink":"/docs/AI Space/Transformers/Transformer-Intro","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Dheeraj Inampudi","lastUpdatedAt":1728498600000,"frontMatter":{"title":"Understanding Attention and Transformer Architectures","label":"Transformer-Intro","category":"ai","last_update":{"date":"10/10/2024","author":"Dheeraj Inampudi"}},"sidebar":"tutorialSidebar","previous":{"title":"AI Space","permalink":"/docs/category/ai-space"},"next":{"title":"Transformer Links","permalink":"/docs/AI Space/Transformers/Transformes-links"}}');var t=n(4848),l=n(8453);const i={title:"Understanding Attention and Transformer Architectures",label:"Transformer-Intro",category:"ai",last_update:{date:"10/10/2024",author:"Dheeraj Inampudi"}},r=void 0,c={},m=[{value:"<strong>1. Attention Mechanism</strong>",id:"1-attention-mechanism",level:3},{value:"<strong>Core Idea</strong>",id:"core-idea",level:4},{value:"<strong>Key Components of Attention</strong>",id:"key-components-of-attention",level:4},{value:"<strong>Self-Attention Formula</strong>",id:"self-attention-formula",level:4},{value:"<strong>Example of Self-Attention</strong>",id:"example-of-self-attention",level:4},{value:"<strong>2. Multi-Head Attention</strong>",id:"2-multi-head-attention",level:3},{value:"<strong>3. Positional Encoding</strong>",id:"3-positional-encoding",level:3},{value:"<strong>4. Transformer Architecture</strong>",id:"4-transformer-architecture",level:3},{value:"<strong>Transformer Encoder</strong>",id:"transformer-encoder",level:4},{value:"<strong>Transformer Decoder</strong>",id:"transformer-decoder",level:4},{value:"<strong>End-to-End Transformer Workflow</strong>",id:"end-to-end-transformer-workflow",level:3},{value:"<strong>Key Strengths of Transformers</strong>",id:"key-strengths-of-transformers",level:3},{value:"<strong>Next Steps</strong>",id:"next-steps",level:3}];function h(s){const e={annotation:"annotation",code:"code",h3:"h3",h4:"h4",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mpadded:"mpadded",mrow:"mrow",mspace:"mspace",msqrt:"msqrt",msub:"msub",msup:"msup",mtext:"mtext",ol:"ol",p:"p",path:"path",semantics:"semantics",span:"span",strong:"strong",svg:"svg",ul:"ul",...(0,l.R)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"RNNs (Storyteller)"}),": Reads a story word by word, remembering only what came before to predict what comes next."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"CNNs (Photographer)"}),": Focuses on details in patches of an image and combines them to form a complete picture."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Transformers (Collaborator)"}),": Reads the entire story at once and learns relationships between all parts simultaneously, identifying which details to focus on globally."]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["Let's break this into two key parts: ",(0,t.jsx)(e.strong,{children:"Attention Mechanism"})," and ",(0,t.jsx)(e.strong,{children:"Transformer Architecture"}),". Each builds on the other, so mastering attention first is critical to understanding the full Transformer model."]}),"\n",(0,t.jsx)(e.h3,{id:"1-attention-mechanism",children:(0,t.jsx)(e.strong,{children:"1. Attention Mechanism"})}),"\n",(0,t.jsxs)(e.p,{children:["The ",(0,t.jsx)(e.strong,{children:"attention mechanism"})," is the foundation of Transformers. It allows the model to ",(0,t.jsx)(e.strong,{children:"focus on relevant parts of the input sequence"})," when generating outputs, addressing limitations of RNNs (like long-range dependencies)."]}),"\n",(0,t.jsx)(e.h4,{id:"core-idea",children:(0,t.jsx)(e.strong,{children:"Core Idea"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Instead of processing sequences step by step (like RNNs), attention compares ",(0,t.jsx)(e.strong,{children:"all tokens"})," in the input to each other to determine relevance."]}),"\n",(0,t.jsxs)(e.li,{children:["It assigns ",(0,t.jsx)(e.strong,{children:"weights (importance scores)"})," to each token based on how much they contribute to understanding a given token or query."]}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"key-components-of-attention",children:(0,t.jsx)(e.strong,{children:"Key Components of Attention"})}),"\n",(0,t.jsxs)(e.p,{children:["Attention is built around the ",(0,t.jsx)(e.strong,{children:"Query (Q)"}),", ",(0,t.jsx)(e.strong,{children:"Key (K)"}),", and ",(0,t.jsx)(e.strong,{children:"Value (V)"})," paradigm."]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Query (Q)"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Represents what you're looking for."}),"\n",(0,t.jsx)(e.li,{children:'Example: In the sentence "The cat sat on the mat," if we\'re focusing on "cat," the query is related to "cat."'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Key (K)"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Represents the characteristics of each token."}),"\n",(0,t.jsx)(e.li,{children:"Example: Every word in the sequence has a key, encoding its meaning."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Value (V)"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Represents the actual content of the tokens."}),"\n",(0,t.jsx)(e.li,{children:'Example: "The", "cat", "sat", etc., are passed as values.'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"self-attention-formula",children:(0,t.jsx)(e.strong,{children:"Self-Attention Formula"})}),"\n",(0,t.jsx)(e.p,{children:"Attention computes relevance scores for each token pair using dot products:"}),"\n",(0,t.jsx)(e.span,{className:"katex-display",children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mtext,{children:"Attention(Q,\xa0K,\xa0V)"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mtext,{children:"softmax"}),(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mo,{fence:"true",children:"("}),(0,t.jsxs)(e.mfrac,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"Q"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"K"}),(0,t.jsx)(e.mi,{children:"T"})]})]}),(0,t.jsx)(e.msqrt,{children:(0,t.jsxs)(e.msub,{children:[(0,t.jsx)(e.mi,{children:"d"}),(0,t.jsx)(e.mi,{children:"k"})]})})]}),(0,t.jsx)(e.mo,{fence:"true",children:")"})]}),(0,t.jsx)(e.mi,{children:"V"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Attention(Q, K, V)} = \\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d_k}}\\right)V"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Attention(Q,\xa0K,\xa0V)"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"2.4684em",verticalAlign:"-0.95em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"softmax"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(e.span,{className:"minner",children:[(0,t.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,t.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(e.span,{className:"mfrac",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.5183em"},children:[(0,t.jsxs)(e.span,{style:{top:"-2.2528em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"mord",children:(0,t.jsx)(e.span,{className:"mord sqrt",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"0.8572em"},children:[(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-3em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"mord",style:{paddingLeft:"0.833em"},children:(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(e.span,{})})})]})})]})})]}),(0,t.jsxs)(e.span,{style:{top:"-2.8172em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{minWidth:"0.853em",height:"1.08em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice",children:(0,t.jsx)(e.path,{d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.1828em"},children:(0,t.jsx)(e.span,{})})})]})})})]}),(0,t.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",children:"Q"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.8413em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"T"})})]})})})})})]})]})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.93em"},children:(0,t.jsx)(e.span,{})})})]})}),(0,t.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,t.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"})]})]})]})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"QK\u1d40"}),": Measures similarity between query and key."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"d\u2096"}),": Scaling factor to avoid large dot products in high dimensions."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"softmax"}),": Converts scores into probabilities (attention weights)."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"V"}),": Final weighted sum of values, representing the focused context."]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h4,{id:"example-of-self-attention",children:(0,t.jsx)(e.strong,{children:"Example of Self-Attention"})}),"\n",(0,t.jsxs)(e.p,{children:["Input sentence: ",(0,t.jsx)(e.code,{children:'"The cat sat on the mat."'})]}),"\n",(0,t.jsx)(e.p,{children:'If the focus is on "cat":'}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Query (",(0,t.jsx)(e.code,{children:"Q"}),') = "cat".']}),"\n",(0,t.jsxs)(e.li,{children:["Each word in the sentence has a ",(0,t.jsxs)(e.strong,{children:["Key (",(0,t.jsx)(e.code,{children:"K"}),")"]})," and ",(0,t.jsxs)(e.strong,{children:["Value (",(0,t.jsx)(e.code,{children:"V"}),")"]}),"."]}),"\n",(0,t.jsxs)(e.li,{children:['The attention mechanism calculates how much each word contributes to "cat" using QK\u1d40:',"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:'"The" \u2192 Low weight (irrelevant).'}),"\n",(0,t.jsx)(e.li,{children:'"sat" \u2192 High weight (verb related to "cat").'}),"\n",(0,t.jsx)(e.li,{children:'"mat" \u2192 Low weight (less connected).'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"2-multi-head-attention",children:(0,t.jsx)(e.strong,{children:"2. Multi-Head Attention"})}),"\n",(0,t.jsxs)(e.p,{children:["A single attention mechanism may miss nuanced relationships (e.g., syntax vs. semantics). ",(0,t.jsx)(e.strong,{children:"Multi-Head Attention"})," solves this by:"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Running multiple attention mechanisms (heads) in parallel."}),"\n",(0,t.jsx)(e.li,{children:"Each head captures different relationships (e.g., word order, context, synonyms)."}),"\n",(0,t.jsx)(e.li,{children:"Outputs are concatenated and projected into a final representation."}),"\n"]}),"\n",(0,t.jsx)(e.span,{className:"katex-display",children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mtext,{children:"MultiHead(Q,\xa0K,\xa0V)"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mtext,{children:"Concat"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(e.msub,{children:[(0,t.jsx)(e.mtext,{children:"head"}),(0,t.jsx)(e.mn,{children:"1"})]}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsxs)(e.msub,{children:[(0,t.jsx)(e.mtext,{children:"head"}),(0,t.jsx)(e.mn,{children:"2"})]}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mo,{children:"\u2026"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsxs)(e.msub,{children:[(0,t.jsx)(e.mtext,{children:"head"}),(0,t.jsx)(e.mi,{children:"h"})]}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"W"}),(0,t.jsx)(e.mi,{children:"O"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{MultiHead(Q, K, V)} = \\text{Concat}(\\text{head}_1, \\text{head}_2, \\dots, \\text{head}_h)W^O"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"MultiHead(Q,\xa0K,\xa0V)"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.1413em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Concat"})}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"head"})}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.55em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"head"})}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.55em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"minner",children:"\u2026"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"head"})}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.55em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})})]})}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.8913em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"O"})})]})})})})})]})]})]})]})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"3-positional-encoding",children:(0,t.jsx)(e.strong,{children:"3. Positional Encoding"})}),"\n",(0,t.jsxs)(e.p,{children:["Transformers process sequences in parallel, so they lack inherent order information (unlike RNNs). ",(0,t.jsx)(e.strong,{children:"Positional Encoding"})," adds order back:"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Each token embedding is enriched with a positional vector."}),"\n",(0,t.jsx)(e.li,{children:"Common approach: Use sine and cosine functions for each position."}),"\n"]}),"\n",(0,t.jsx)(e.span,{className:"katex-display",children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mtext,{children:"PosEnc(pos,\xa02i)"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"sin"}),(0,t.jsx)(e.mo,{children:"\u2061"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(e.mfrac,{children:[(0,t.jsx)(e.mtext,{children:"pos"}),(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mn,{children:"1000"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mn,{children:"0"}),(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mn,{children:"2"}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,t.jsx)(e.mi,{children:"d"})]})]})]})]}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mspace,{width:"1em"}),(0,t.jsx)(e.mtext,{children:"PosEnc(pos,\xa02i+1)"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"cos"}),(0,t.jsx)(e.mo,{children:"\u2061"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(e.mfrac,{children:[(0,t.jsx)(e.mtext,{children:"pos"}),(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mn,{children:"1000"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mn,{children:"0"}),(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mn,{children:"2"}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,t.jsx)(e.mi,{children:"d"})]})]})]})]}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{PosEnc(pos, 2i)} = \\sin(\\frac{\\text{pos}}{10000^{2i/d}}), \\quad \\text{PosEnc(pos, 2i+1)} = \\cos(\\frac{\\text{pos}}{10000^{2i/d}})"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"PosEnc(pos,\xa02i)"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.8116em",verticalAlign:"-0.704em"}}),(0,t.jsx)(e.span,{className:"mop",children:"sin"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(e.span,{className:"mfrac",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1076em"},children:[(0,t.jsxs)(e.span,{style:{top:"-2.296em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord",children:"1000"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord",children:"0"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.814em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(e.span,{className:"mord mtight",children:[(0,t.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,t.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(e.span,{className:"mord mtight",children:"/"}),(0,t.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})]})})]})})})})})]})]})]}),(0,t.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"mord",children:(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"pos"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.704em"},children:(0,t.jsx)(e.span,{})})})]})}),(0,t.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"PosEnc(pos,\xa02i+1)"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.8116em",verticalAlign:"-0.704em"}}),(0,t.jsx)(e.span,{className:"mop",children:"cos"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(e.span,{className:"mfrac",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1076em"},children:[(0,t.jsxs)(e.span,{style:{top:"-2.296em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord",children:"1000"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord",children:"0"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.814em"},children:(0,t.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(e.span,{className:"mord mtight",children:[(0,t.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,t.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,t.jsx)(e.span,{className:"mord mtight",children:"/"}),(0,t.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})]})})]})})})})})]})]})]}),(0,t.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(e.span,{className:"mord",children:(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"pos"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.704em"},children:(0,t.jsx)(e.span,{})})})]})}),(0,t.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"4-transformer-architecture",children:(0,t.jsx)(e.strong,{children:"4. Transformer Architecture"})}),"\n",(0,t.jsxs)(e.p,{children:["The ",(0,t.jsx)(e.strong,{children:"Transformer"})," builds on attention by combining ",(0,t.jsx)(e.strong,{children:"Self-Attention"}),", ",(0,t.jsx)(e.strong,{children:"Feed-Forward Networks (FFN)"}),", and ",(0,t.jsx)(e.strong,{children:"Residual Connections"})," in a modular, stackable architecture."]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h4,{id:"transformer-encoder",children:(0,t.jsx)(e.strong,{children:"Transformer Encoder"})}),"\n",(0,t.jsx)(e.p,{children:"Encodes the input into a rich contextual representation."}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"One Encoder Block:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Multi-Head Self-Attention"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Computes relationships between all tokens in the input."}),"\n",(0,t.jsx)(e.li,{children:"Outputs context-aware embeddings for each token."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Feed-Forward Network (FFN)"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Applies two dense layers with non-linear activation."}),"\n",(0,t.jsx)(e.li,{children:"Refines the token representations."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Residual Connections and Layer Normalization"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Residual connections stabilize training by adding the input back to the output of attention/FFN layers."}),"\n",(0,t.jsx)(e.li,{children:"Layer normalization improves gradient flow."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Structure"}),":"]}),"\n",(0,t.jsx)(e.span,{className:"katex-display",children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mtext,{children:"Input\xa0Embeddings"}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"Self-Attention"})})]}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"FFN"})})]}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"Normalization"})})]}),(0,t.jsx)(e.mtext,{children:"Output\xa0Embeddings"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Input Embeddings} \\xrightarrow{\\text{Self-Attention}} \\xrightarrow{\\text{FFN}} \\xrightarrow{\\text{Normalization}} \\text{Output Embeddings}"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.3025em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Input\xa0Embeddings"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1081em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"Self-Attention"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.1113em",verticalAlign:"-0.011em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1003em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"FFN"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.1191em",verticalAlign:"-0.011em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1081em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"Normalization"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Output\xa0Embeddings"})})]})]})]})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h4,{id:"transformer-decoder",children:(0,t.jsx)(e.strong,{children:"Transformer Decoder"})}),"\n",(0,t.jsx)(e.p,{children:"Generates the output sequence step-by-step."}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"One Decoder Block:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Masked Multi-Head Attention"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Ensures the decoder only attends to already-generated tokens (causal attention)."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Cross-Attention"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Allows the decoder to attend to the encoder's outputs for context (important for tasks like translation)."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Feed-Forward Network and Residual Connections"}),":"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Similar to the encoder."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Structure"}),":"]}),"\n",(0,t.jsx)(e.span,{className:"katex-display",children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mtext,{children:"Generated\xa0Embeddings"}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"Masked\xa0Self-Attention"})})]}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"Cross-Attention"})})]}),(0,t.jsxs)(e.mover,{children:[(0,t.jsx)(e.mo,{stretchy:"true",minsize:"3.0em",children:"\u2192"}),(0,t.jsx)(e.mpadded,{width:"+0.6em",lspace:"0.3em",children:(0,t.jsx)(e.mtext,{children:"FFN"})})]}),(0,t.jsx)(e.mtext,{children:"Next\xa0Token\xa0Embedding"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Generated Embeddings} \\xrightarrow{\\text{Masked Self-Attention}} \\xrightarrow{\\text{Cross-Attention}} \\xrightarrow{\\text{FFN}} \\text{Next Token Embedding}"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.3025em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Generated\xa0Embeddings"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1081em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"Masked\xa0Self-Attention"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.1113em",verticalAlign:"-0.011em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1003em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"Cross-Attention"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.1113em",verticalAlign:"-0.011em"}}),(0,t.jsx)(e.span,{className:"mrel x-arrow",children:(0,t.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(e.span,{className:"vlist-r",children:[(0,t.jsxs)(e.span,{className:"vlist",style:{height:"1.1003em"},children:[(0,t.jsxs)(e.span,{style:{top:"-3.322em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight x-arrow-pad",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord text mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"FFN"})})})})]}),(0,t.jsxs)(e.span,{className:"svg-align",style:{top:"-2.689em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"hide-tail",style:{height:"0.522em",minWidth:"1.469em"},children:(0,t.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"0.522em",viewBox:"0 0 400000 522",preserveAspectRatio:"xMaxYMin slice",children:(0,t.jsx)(e.path,{d:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z"})})})]})]}),(0,t.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.011em"},children:(0,t.jsx)(e.span,{})})})]})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord",children:"Next\xa0Token\xa0Embedding"})})]})]})]})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"end-to-end-transformer-workflow",children:(0,t.jsx)(e.strong,{children:"End-to-End Transformer Workflow"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Input Processing"}),":","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:'Tokenize input (e.g., "The cat sat").'}),"\n",(0,t.jsx)(e.li,{children:"Add positional encodings."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Encoder"}),":","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Processes input embeddings into contextual representations."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Decoder"}),":","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Predicts the next token based on encoder outputs and already-generated tokens."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Output"}),":","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Decodes token predictions into readable text."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"key-strengths-of-transformers",children:(0,t.jsx)(e.strong,{children:"Key Strengths of Transformers"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Handles Long-Range Dependencies"}),": Self-attention captures relationships between distant tokens."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Parallelizable"}),": Processes sequences in parallel, unlike RNNs."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Scalable"}),": Stacking multiple encoder/decoder blocks improves performance on large datasets."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Adaptable"}),": Works across NLP, vision, and multimodal tasks."]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"next-steps",children:(0,t.jsx)(e.strong,{children:"Next Steps"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["Experiment with ",(0,t.jsx)(e.strong,{children:"attention matrices"})," (visualizing weights)."]}),"\n",(0,t.jsx)(e.li,{children:"Implement a small Transformer from scratch to solidify understanding."}),"\n",(0,t.jsx)(e.li,{children:"Explore pre-trained models (e.g., BERT, GPT) to see Transformers in action."}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"Let me know if you'd like help with visualizations, implementations, or examples!"})]})}function d(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,t.jsx)(e,{...s,children:(0,t.jsx)(h,{...s})}):h(s)}},8453:(s,e,n)=>{n.d(e,{R:()=>i,x:()=>r});var a=n(6540);const t={},l=a.createContext(t);function i(s){const e=a.useContext(l);return a.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(t):s.components||t:i(s.components),a.createElement(l.Provider,{value:e},s.children)}}}]);